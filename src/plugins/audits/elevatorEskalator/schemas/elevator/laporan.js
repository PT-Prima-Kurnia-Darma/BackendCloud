'use strict';

const Joi = require('joi');

// Skema untuk setiap item inspeksi, sekarang sepenuhnya opsional
const inspectionItemSchema = Joi.object({
    result: Joi.string().allow('').optional(),
    status: Joi.boolean().optional()
}).optional();

// Skema payload utama, di mana semua field dan objek bersifat opsional
const laporanElevatorPayload = Joi.object({
    inspectionType: Joi.string().allow('').optional(),
    subInspectionType: Joi.string().allow('').optional(),
    examinationType: Joi.string().allow('').optional(),
    createdAt: Joi.string().allow('').optional(),
    equipmentType: Joi.string().allow('').optional(),

    generalData: Joi.object({
        ownerName: Joi.string().allow('').optional(),
        ownerAddress: Joi.string().allow('').optional(),
        nameUsageLocation: Joi.string().allow('').optional(),
        addressUsageLocation: Joi.string().allow('').optional(),
        manufacturerOrInstaller: Joi.string().allow('').optional(),
        elevatorType: Joi.string().allow('').optional(),
        brandOrType: Joi.string().allow('').optional(),
        countryAndYear: Joi.string().allow('').optional(),
        serialNumber: Joi.string().allow('').optional(),
        capacity: Joi.string().allow('').optional(),
        speed: Joi.string().allow('').optional(),
        floorsServed: Joi.string().allow('').optional(),
        permitNumber: Joi.string().allow('').optional(),
        inspectionDate: Joi.string().allow('').optional()
    }).optional(),

    technicalDocumentInspection: Joi.object({
        designDrawing: Joi.boolean().optional(),
        technicalCalculation: Joi.boolean().optional(),
        materialCertificate: Joi.boolean().optional(),
        controlPanelDiagram: Joi.boolean().optional(),
        asBuiltDrawing: Joi.boolean().optional(),
        componentCertificates: Joi.boolean().optional(),
        safeWorkProcedure: Joi.boolean().optional()
    }).optional(),

    inspectionAndTesting: Joi.object({
        machineRoomAndMachinery: Joi.object({
            machineMounting: inspectionItemSchema,
            mechanicalBrake: inspectionItemSchema,
            electricalBrake: inspectionItemSchema,
            machineRoomConstruction: inspectionItemSchema,
            machineRoomClearance: inspectionItemSchema,
            machineRoomImplementation: inspectionItemSchema,
            ventilation: inspectionItemSchema,
            machineRoomDoor: inspectionItemSchema,
            mainPowerPanelPosition: inspectionItemSchema,
            rotatingPartsGuard: inspectionItemSchema,
            ropeHoleGuard: inspectionItemSchema,
            machineRoomAccessLadder: inspectionItemSchema,
            floorLevelDifference: inspectionItemSchema,
            fireExtinguisher: inspectionItemSchema,
            machineRoomless: Joi.object({
                panelPlacement: inspectionItemSchema,
                lightingWorkArea: inspectionItemSchema,
                lightingBetweenWorkArea: inspectionItemSchema,
                manualBrakeRelease: inspectionItemSchema,
                fireExtinguisherPlacement: inspectionItemSchema,
            }).optional(),
            emergencyStopSwitch: inspectionItemSchema,
        }).optional(),
        suspensionRopesAndBelts: Joi.object({
            condition: inspectionItemSchema,
            chainUsage: inspectionItemSchema,
            safetyFactor: inspectionItemSchema,
            ropeWithCounterweight: inspectionItemSchema,
            ropeWithoutCounterweight: inspectionItemSchema,
            belt: inspectionItemSchema,
            slackRopeDevice: inspectionItemSchema,
        }).optional(),
        drumsAndSheaves: Joi.object({
            drumGrooves: inspectionItemSchema,
            passengerDrumDiameter: inspectionItemSchema,
            governorDrumDiameter: inspectionItemSchema,
        }).optional(),
        hoistwayAndPit: Joi.object({
            construction: inspectionItemSchema,
            walls: inspectionItemSchema,
            inclinedElevatorTrackBed: inspectionItemSchema,
            cleanliness: inspectionItemSchema,
            lighting: inspectionItemSchema,
            emergencyDoorNonStop: inspectionItemSchema,
            emergencyDoorSize: inspectionItemSchema,
            emergencyDoorSafetySwitch: inspectionItemSchema,
            emergencyDoorBridge: inspectionItemSchema,
            carTopClearance: inspectionItemSchema,
            pitClearance: inspectionItemSchema,
            pitLadder: inspectionItemSchema,
            pitBelowWorkingArea: inspectionItemSchema,
            pitAccessSwitch: inspectionItemSchema,
            pitScreen: inspectionItemSchema,
            hoistwayDoorLeaf: inspectionItemSchema,
            hoistwayDoorInterlock: inspectionItemSchema,
            floorLeveling: inspectionItemSchema,
            hoistwaySeparatorBeam: inspectionItemSchema,
            inclinedElevatorStairs: inspectionItemSchema,
        }).optional(),
        car: Joi.object({
            frame: inspectionItemSchema,
            body: inspectionItemSchema,
            wallHeight: inspectionItemSchema,
            floorArea: inspectionItemSchema,
            carAreaExpansion: inspectionItemSchema,
            carDoor: inspectionItemSchema,
            carDoorSpecs: Joi.object({
                size: inspectionItemSchema,
                lockAndSwitch: inspectionItemSchema,
                sillClearance: inspectionItemSchema,
            }).optional(),
            carToBeamClearance: inspectionItemSchema,
            alarmBell: inspectionItemSchema,
            backupPowerARD: inspectionItemSchema,
            intercom: inspectionItemSchema,
            ventilation: inspectionItemSchema,
            emergencyLighting: inspectionItemSchema,
            operatingPanel: inspectionItemSchema,
            carPositionIndicator: inspectionItemSchema,
            carSignage: Joi.object({
                manufacturerName: inspectionItemSchema,
                loadCapacity: inspectionItemSchema,
                noSmokingSign: inspectionItemSchema,
                overloadIndicator: inspectionItemSchema,
                doorOpenCloseButtons: inspectionItemSchema,
                floorButtons: inspectionItemSchema,
                alarmButton: inspectionItemSchema,
                twoWayIntercom: inspectionItemSchema,
            }).optional(),
            carRoofStrength: inspectionItemSchema,
            carTopEmergencyExit: inspectionItemSchema,
            carSideEmergencyExit: inspectionItemSchema,
            carTopGuardRail: inspectionItemSchema,
            guardRailHeight300to850: inspectionItemSchema,
            guardRailHeightOver850: inspectionItemSchema,
            carTopLighting: inspectionItemSchema,
            manualOperationButtons: inspectionItemSchema,
            carInterior: inspectionItemSchema,
        }).optional(),
        governorAndSafetyBrake: Joi.object({
            governorRopeClamp: inspectionItemSchema,
            governorSwitch: inspectionItemSchema,
            safetyBrakeSpeed: inspectionItemSchema,
            safetyBrakeType: inspectionItemSchema,
            safetyBrakeMechanism: inspectionItemSchema,
            progressiveSafetyBrake: inspectionItemSchema,
            instantaneousSafetyBrake: inspectionItemSchema,
            safetyBrakeOperation: inspectionItemSchema,
            electricalCutoutSwitch: inspectionItemSchema,
            limitSwitch: inspectionItemSchema,
            overloadDevice: inspectionItemSchema,
        }).optional(),
        counterweightGuideRailsAndBuffers: Joi.object({
            counterweightMaterial: inspectionItemSchema,
            counterweightGuardScreen: inspectionItemSchema,
            guideRailConstruction: inspectionItemSchema,
            bufferType: inspectionItemSchema,
            bufferFunction: inspectionItemSchema,
            bufferSafetySwitch: inspectionItemSchema,
        }).optional(),
        electricalInstallation: Joi.object({
            installationStandard: inspectionItemSchema,
            electricalPanel: inspectionItemSchema,
            backupPowerARD: inspectionItemSchema,
            groundingCable: inspectionItemSchema,
            fireAlarmConnection: inspectionItemSchema,
            fireServiceElevator: Joi.object({
                backupPower: inspectionItemSchema,
                specialOperation: inspectionItemSchema,
                fireSwitch: inspectionItemSchema,
                label: inspectionItemSchema,
                electricalFireResistance: inspectionItemSchema,
                hoistwayWallFireResistance: inspectionItemSchema,
                carSize: inspectionItemSchema,
                doorSize: inspectionItemSchema,
                travelTime: inspectionItemSchema,
                evacuationFloor: inspectionItemSchema,
            }).optional(),
            accessibilityElevator: Joi.object({
                operatingPanel: inspectionItemSchema,
                panelHeight: inspectionItemSchema,
                doorOpenTime: inspectionItemSchema,
                doorWidth: inspectionItemSchema,
                audioInformation: inspectionItemSchema,
                label: inspectionItemSchema,
            }).optional(),
            seismicSensor: Joi.object({
                availability: inspectionItemSchema,
                function: inspectionItemSchema,
            }).optional(),
        }).optional(),
    }).optional(),
    
    conclusion: Joi.string().allow('').optional()
}).unknown(false).min(1);

module.exports = {
    laporanElevatorPayload,
};