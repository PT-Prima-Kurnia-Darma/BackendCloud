'use strict';

const PizZip = require('pizzip');
const Docxtemplater = require('docxtemplater');
const { Storage } = require('@google-cloud/storage');
const config = require('../../../../../config');

// Inisialisasi GCS
let privateKey = config.FIRESTORE_PRIVATE_KEY.replace(/\\n/g, '\n');
const storage = new Storage({
    projectId: config.FIRESTORE_PROJECT_ID,
    credentials: { client_email: config.FIRESTORE_CLIENT_EMAIL, private_key: privateKey },
});
const BUCKET_NAME = 'tamplate-audit-riksauji';

// Fungsi helper untuk mendapatkan tanda centang (√) berdasarkan status boolean
const getCheckmark = (status) => (status === true ? '√' : '');
// Fungsi helper untuk kondisi sebaliknya (jika false, maka dicentang)
const getOppositeCheckmark = (status) => (status === false ? '√' : '');

// === FUNGSI HELPER BARU DITAMBAHKAN DI SINI ===
const formatDefleksiResult = (status) => {
    if (status === true) {
        return 'Memenuhi Syarat';
    }
    if (status === false) {
        return 'Tidak Memenuhi Syarat';
    }
    // Teks default jika datanya null atau undefined
    return '(Memenuhi Syarat / Tidak Memenuhi Syarat)';
};

const createLaporanGantryCrane = async (data) => {
    const templatePath = 'paa/gantryCrane/laporanGantryCrane.docx';

    let content;
    try {
        [content] = await storage.bucket(BUCKET_NAME).file(templatePath).download();
    } catch (error) {
        console.error('Gagal mengunduh template Laporan Gantry Crane:', error);
        throw new Error('Template dokumen Laporan Gantry Crane tidak dapat diakses.');
    }

    const zip = new PizZip(content);
    const doc = new Docxtemplater(zip, { paragraphLoop: true, linebreaks: true, nullGetter: () => "" });

    // Destrukturisasi data untuk kemudahan akses
    const g = data.generalData || {};
    const t = data.technicalData || {};
    const vi = data.visualInspection || {};
    const ndt = data.ndt || {};
    const dyn = data.dynamicTesting || {};
    const stat = data.staticTesting || {};

    // Objek renderData dengan semua variabel yang ditulis secara eksplisit
    const renderData = {
        // Data Utama (Root Level)
        examinationType: data.examinationType || '',
        inspectionType: data.inspectionType || '',
        reportNumber: data.reportNumber || '',
        equipmentType: data.equipmentType || '',
        subInspectionType: data.subInspectionType || '',

        // General Data
        companyName: g.companyName || '',
        companyLocation: g.companyLocation || '',
        usageLocation: g.usageLocation || '',
        location: g.location || '',
        manufacturerHoist: g.manufacturerHoist || '',
        manufacturerStructure: g.manufacturerStructure || '',
        brandOrType: g.brandOrType || '',
        manufactureYear: g.manufactureYear || '',
        serialNumber: g.serialNumber || '',
        maxLiftingCapacityKg: g.maxLiftingCapacityKg || '',
        usagePermitNumber: g.usagePermitNumber || '',
        operatorcertificateStatus: g.operatorcertificateStatus || '',
        technicalDataManualStatus: g.technicalDataManualStatus || '',
        inspectionDate: g.inspectionDate || '',

        // Technical Data
        liftHeight: t.liftHeight || '',
        girderLength: t.girderLength || '',
        hoistingSpeed: t.hoistingSpeed || '',
        travelingSpeed: t.travelingSpeed || '',
        traversingSpeed: t.traversingSpeed || '',
        driveMotorcapacity: t.driveMotorcapacity || '',
        hoistingpowerKw: t.hoistingpowerKw || '',
        travelingpowerKw: t.travelingpowerKw || '',
        traversingpowerKw: t.traversingpowerKw || '',
        hoistingtype: t.hoistingtype || '',
        travelingtype: t.travelingtype || '',
        traversingtype: t.traversingtype || '',
        hoistingrpm: t.hoistingrpm || '',
        travelingrpm: t.travelingrpm || '',
        traversingrpm: t.traversingrpm || '',
        hoistingvoltageV: t.hoistingvoltageV || '',
        travelingvoltageV: t.travelingvoltageV || '',
        traversingvoltageV: t.traversingvoltageV || '',
        hoistingcurrentA: t.hoistingcurrentA || '',
        travelingcurrentA: t.travelingcurrentA || '',
        traversingcurrentA: t.traversingcurrentA || '',
        hoistingfrequencyHz: t.hoistingfrequencyHz || '',
        travelingfrequencyHz: t.travelingfrequencyHz || '',
        traversingfrequencyHz: t.traversingfrequencyHz || '',
        hoistingphase: t.hoistingphase || '',
        travelingphase: t.travelingphase || '',
        traversingphase: t.traversingphase || '',
        hoistingpowerSupply: t.hoistingpowerSupply || '',
        travelingpowerSupply: t.travelingpowerSupply || '',
        traversingpowerSupply: t.traversingpowerSupply || '',
        braketype: t.braketype || '',
        brakemodel: t.brakemodel || '',
        controlBrakehoistingtype: t.controlBrakehoistingtype || '',
        controlBraketravelingtype: t.controlBraketravelingtype || '',
        controlBraketraversingtype: t.controlBraketraversingtype || '',
        controlBrakehoistingmodel: t.controlBrakehoistingmodel || '',
        controlBraketravelingmodel: t.controlBraketravelingmodel || '',
        controlBraketraversingmodel: t.controlBraketraversingmodel || '',
        hookhoistingtype: t.hookhoistingtype || '',
        hooktravelingtype: t.hooktravelingtype || '',
        hooktraversingtype: t.hooktraversingtype || '',
        hookhoistingcapacity: t.hookhoistingcapacity || '',
        hooktravelingcapacity: t.hooktravelingcapacity || '',
        hooktraversingcapacity: t.hooktraversingcapacity || '',
        hookhoistingmaterial: t.hookhoistingmaterial || '',
        hooktravelingmaterial: t.hooktravelingmaterial || '',
        hooktraversingmaterial: t.hooktraversingmaterial || '',
        wireRopeOrChainmediumType: t.wireRopeOrChainmediumType || '',
        mediumTypehoistingtype: t.mediumTypehoistingtype || '',
        mediumTypetravelingtype: t.mediumTypetravelingtype || '',
        mediumTypetraversingtype: t.mediumTypetraversingtype || '',
        mediumTypehoistingconstruction: t.mediumTypehoistingconstruction || '',
        mediumTypetravelingconstruction: t.mediumTypetravelingconstruction || '',
        mediumTypetraversingconstruction: t.mediumTypetraversingconstruction || '',
        mediumTypehoistingdiameter: t.mediumTypehoistingdiameter || '',
        mediumTypetravelingdiameter: t.mediumTypetravelingdiameter || '',
        mediumTypetraversingdiameter: t.mediumTypetraversingdiameter || '',
        mediumTypehoistinglength: t.mediumTypehoistinglength || '',
        mediumTypetravelinglength: t.mediumTypetravelinglength || '',
        mediumTypetraversinglength: t.mediumTypetraversinglength || '',

        // Visual Inspection (Semua field ditulis lengkap)
        anchorBoltscorrosionMemenuhi: getCheckmark(vi.anchorBoltscorrosionMemenuhi),
        anchorBoltscorrosionTidakMemenuhi: getOppositeCheckmark(vi.anchorBoltscorrosionMemenuhi),
        anchorBoltscorrosionResult: vi.anchorBoltscorrosionResult || '',
        anchorBoltscracksMemenuhi: getCheckmark(vi.anchorBoltscracksMemenuhi),
        anchorBoltscracksTidakMemenuhi: getOppositeCheckmark(vi.anchorBoltscracksMemenuhi),
        anchorBoltscracksResult: vi.anchorBoltscracksResult || '',
        anchorBoltsdeformationMemenuhi: getCheckmark(vi.anchorBoltsdeformationMemenuhi),
        anchorBoltsdeformationTidakMemenuhi: getOppositeCheckmark(vi.anchorBoltsdeformationMemenuhi),
        anchorBoltsdeformationResult: vi.anchorBoltsdeformationResult || '',
        anchorBoltsfasteningMemenuhi: getCheckmark(vi.anchorBoltsfasteningMemenuhi),
        anchorBoltsfasteningTidakMemenuhi: getOppositeCheckmark(vi.anchorBoltsfasteningMemenuhi),
        anchorBoltsfasteningResult: vi.anchorBoltsfasteningResult || '',
        columnFramecorrosionMemenuhi: getCheckmark(vi.columnFramecorrosionMemenuhi),
        columnFramecorrosionTidakMemenuhi: getOppositeCheckmark(vi.columnFramecorrosionMemenuhi),
        columnFramecorrosionResult: vi.columnFramecorrosionResult || '',
        columnFramecracksMemenuhi: getCheckmark(vi.columnFramecracksMemenuhi),
        columnFramecracksTidakMemenuhi: getOppositeCheckmark(vi.columnFramecracksMemenuhi),
        columnFramecracksResult: vi.columnFramecracksResult || '',
        columnFramedeformationMemenuhi: getCheckmark(vi.columnFramedeformationMemenuhi),
        columnFramedeformationTidakMemenuhi: getOppositeCheckmark(vi.columnFramedeformationMemenuhi),
        columnFramedeformationResult: vi.columnFramedeformationResult || '',
        columnFramefasteningMemenuhi: getCheckmark(vi.columnFramefasteningMemenuhi),
        columnFramefasteningTidakMemenuhi: getOppositeCheckmark(vi.columnFramefasteningMemenuhi),
        columnFramefasteningResult: vi.columnFramefasteningResult || '',
        columnFrametransverseReinforcementMemenuhi: getCheckmark(vi.columnFrametransverseReinforcementMemenuhi),
        columnFrametransverseReinforcementTidakMemenuhi: getOppositeCheckmark(vi.columnFrametransverseReinforcementMemenuhi),
        columnFrametransverseReinforcementResult: vi.columnFrametransverseReinforcementResult || '',
        columnFramediagonalReinforcementMemenuhi: getCheckmark(vi.columnFramediagonalReinforcementMemenuhi),
        columnFramediagonalReinforcementTidakMemenuhi: getOppositeCheckmark(vi.columnFramediagonalReinforcementMemenuhi),
        columnFramediagonalReinforcementResult: vi.columnFramediagonalReinforcementResult || '',
        laddercorrosionMemenuhi: getCheckmark(vi.laddercorrosionMemenuhi),
        laddercorrosionTidakMemenuhi: getOppositeCheckmark(vi.laddercorrosionMemenuhi),
        laddercorrosionResult: vi.laddercorrosionResult || '',
        laddercracksMemenuhi: getCheckmark(vi.laddercracksMemenuhi),
        laddercracksTidakMemenuhi: getOppositeCheckmark(vi.laddercracksMemenuhi),
        laddercracksResult: vi.laddercracksResult || '',
        ladderdeformationMemenuhi: getCheckmark(vi.ladderdeformationMemenuhi),
        ladderdeformationTidakMemenuhi: getOppositeCheckmark(vi.ladderdeformationMemenuhi),
        ladderdeformationResult: vi.ladderdeformationResult || '',
        ladderfasteningMemenuhi: getCheckmark(vi.ladderfasteningMemenuhi),
        ladderfasteningTidakMemenuhi: getOppositeCheckmark(vi.ladderfasteningMemenuhi),
        ladderfasteningResult: vi.ladderfasteningResult || '',
        workingFloorcorrosionMemenuhi: getCheckmark(vi.workingFloorcorrosionMemenuhi),
        workingFloorcorrosionTidakMemenuhi: getOppositeCheckmark(vi.workingFloorcorrosionMemenuhi),
        workingFloorcorrosionResult: vi.workingFloorcorrosionResult || '',
        workingFloorcracksMemenuhi: getCheckmark(vi.workingFloorcracksMemenuhi),
        workingFloorcracksTidakMemenuhi: getOppositeCheckmark(vi.workingFloorcracksMemenuhi),
        workingFloorcracksResult: vi.workingFloorcracksResult || '',
        workingFloordeformationMemenuhi: getCheckmark(vi.workingFloordeformationMemenuhi),
        workingFloordeformationTidakMemenuhi: getOppositeCheckmark(vi.workingFloordeformationMemenuhi),
        workingFloordeformationResult: vi.workingFloordeformationResult || '',
        workingFloorfasteningMemenuhi: getCheckmark(vi.workingFloorfasteningMemenuhi),
        workingFloorfasteningTidakMemenuhi: getOppositeCheckmark(vi.workingFloorfasteningMemenuhi),
        workingFloorfasteningResult: vi.workingFloorfasteningResult || '',
        railSupportBeamcorrosionMemenuhi: getCheckmark(vi.railSupportBeamcorrosionMemenuhi),
        railSupportBeamcorrosionTidakMemenuhi: getOppositeCheckmark(vi.railSupportBeamcorrosionMemenuhi),
        railSupportBeamcorrosionResult: vi.railSupportBeamcorrosionResult || '',
        railSupportBeamcracksMemenuhi: getCheckmark(vi.railSupportBeamcracksMemenuhi),
        railSupportBeamcracksTidakMemenuhi: getOppositeCheckmark(vi.railSupportBeamcracksMemenuhi),
        railSupportBeamcracksResult: vi.railSupportBeamcracksResult || '',
        railSupportBeamdeformationMemenuhi: getCheckmark(vi.railSupportBeamdeformationMemenuhi),
        railSupportBeamdeformationTidakMemenuhi: getOppositeCheckmark(vi.railSupportBeamdeformationMemenuhi),
        railSupportBeamdeformationResult: vi.railSupportBeamdeformationResult || '',
        railSupportBeamfasteningMemenuhi: getCheckmark(vi.railSupportBeamfasteningMemenuhi),
        railSupportBeamfasteningTidakMemenuhi: getOppositeCheckmark(vi.railSupportBeamfasteningMemenuhi),
        railSupportBeamfasteningResult: vi.railSupportBeamfasteningResult || '',
        travelingRailcorrosionMemenuhi: getCheckmark(vi.travelingRailcorrosionMemenuhi),
        travelingRailcracksTidakMemenuhi: getOppositeCheckmark(vi.travelingRailcorrosionMemenuhi),
        travelingRailcracksResult: vi.travelingRailcracksResult || '',
        travelingcracksMemenuhi: getCheckmark(vi.travelingcracksMemenuhi),
        travelingcracksTidakMemenuhi: getOppositeCheckmark(vi.travelingcracksMemenuhi),
        travelingcracksResult: vi.travelingcracksResult || '',
        travelingrailConnectionMemenuhi: getCheckmark(vi.travelingrailConnectionMemenuhi),
        travelingrailConnectionTidakMemenuhi: getOppositeCheckmark(vi.travelingrailConnectionMemenuhi),
        travelingrailConnectionResult: vi.travelingrailConnectionResult || '',
        travelingrailAlignmentMemenuhi: getCheckmark(vi.travelingrailAlignmentMemenuhi),
        travelingrailAlignmentTidakMemenuhi: getOppositeCheckmark(vi.travelingrailAlignmentMemenuhi),
        travelingrailAlignmentResult: vi.travelingrailAlignmentResult || '',
        travelinginterRailAlignmentMemenuhi: getCheckmark(vi.travelinginterRailAlignmentMemenuhi),
        travelinginterRailAlignmentTidakMemenuhi: getOppositeCheckmark(vi.travelinginterRailAlignmentMemenuhi),
        travelinginterRailAlignmentResult: vi.travelinginterRailAlignmentResult || '',
        travelinginterRailFlatnessMemenuhi: getCheckmark(vi.travelinginterRailFlatnessMemenuhi),
        travelinginterRailFlatnessTidakMemenuhi: getOppositeCheckmark(vi.travelinginterRailFlatnessMemenuhi),
        travelinginterRailFlatnessResult: vi.travelinginterRailFlatnessResult || '',
        travelingrailConnectionGapMemenuhi: getCheckmark(vi.travelingrailConnectionGapMemenuhi),
        travelingrailConnectionGapTidakMemenuhi: getOppositeCheckmark(vi.travelingrailConnectionGapMemenuhi),
        travelingrailConnectionGapResult: vi.travelingrailConnectionGapResult || '',
        travelingrailFastenerMemenuhi: getCheckmark(vi.travelingrailFastenerMemenuhi),
        travelingrailFastenerTidakMemenuhi: getOppositeCheckmark(vi.travelingrailFastenerMemenuhi),
        travelingrailFastenerResult: vi.travelingrailFastenerResult || '',
        travelingrailStopperMemenuhi: getCheckmark(vi.travelingrailStopperMemenuhi),
        travelingrailStopperTidakMemenuhi: getOppositeCheckmark(vi.travelingrailStopperMemenuhi),
        travelingrailStopperResult: vi.travelingrailStopperResult || '',
        traversingRailcorrosionMemenuhi: getCheckmark(vi.traversingRailcorrosionMemenuhi),
        traversingRailcorrosionTidakMemenuhi: getOppositeCheckmark(vi.traversingRailcorrosionMemenuhi),
        traversingRailcorrosionResult: vi.traversingRailcorrosionResult || '',
        traversingRailcracksMemenuhi: getCheckmark(vi.traversingRailcracksMemenuhi),
        traversingRailcracksTidakMemenuhi: getOppositeCheckmark(vi.traversingRailcracksMemenuhi),
        traversingRailcracksResult: vi.traversingRailcracksResult || '',
        traversingRailrailConnectionMemenuhi: getCheckmark(vi.traversingRailrailConnectionMemenuhi),
        traversingRailrailConnectionTidakMemenuhi: getOppositeCheckmark(vi.traversingRailrailConnectionMemenuhi),
        traversingRailrailConnectionResult: vi.traversingRailrailConnectionResult || '',
        traversingRailrailAlignmentMemenuhi: getCheckmark(vi.traversingRailrailAlignmentMemenuhi),
        traversingRailrailAlignmentTidakMemenuhi: getOppositeCheckmark(vi.traversingRailrailAlignmentMemenuhi),
        traversingRailrailAlignmentResult: vi.traversingRailrailAlignmentResult || '',
        traversingRailinterRailAlignmentMemenuhi: getCheckmark(vi.traversingRailinterRailAlignmentMemenuhi),
        traversingRailinterRailAlignmentTidakMemenuhi: getOppositeCheckmark(vi.traversingRailinterRailAlignmentMemenuhi),
        traversingRailinterRailAlignmentResult: vi.traversingRailinterRailAlignmentResult || '',
        traversingRailinterRailFlatnessMemenuhi: getCheckmark(vi.traversingRailinterRailFlatnessMemenuhi),
        traversingRailinterRailFlatnessTidakMemenuhi: getOppositeCheckmark(vi.traversingRailinterRailFlatnessMemenuhi),
        traversingRailinterRailFlatnessResult: vi.traversingRailinterRailFlatnessResult || '',
        traversingRailrailConnectionGapMemenuhi: getCheckmark(vi.traversingRailrailConnectionGapMemenuhi),
        traversingRailrailConnectionGapTidakMemenuhi: getOppositeCheckmark(vi.traversingRailrailConnectionGapMemenuhi),
        traversingRailrailConnectionGapResult: vi.traversingRailrailConnectionGapResult || '',
        traversingRailrailFastenerMemenuhi: getCheckmark(vi.traversingRailrailFastenerMemenuhi),
        traversingRailrailFastenerTidakMemenuhi: getOppositeCheckmark(vi.traversingRailrailFastenerMemenuhi),
        traversingRailrailFastenerResult: vi.traversingRailrailFastenerResult || '',
        traversingRailrailStopperMemenuhi: getCheckmark(vi.traversingRailrailStopperMemenuhi),
        traversingRailrailStopperTidakMemenuhi: getOppositeCheckmark(vi.traversingRailrailStopperMemenuhi),
        traversingRailrailStopperResult: vi.traversingRailrailStopperResult || '',
        girdercorrosionMemenuhi: getCheckmark(vi.girdercorrosionMemenuhi),
        girdercorrosionTidakMemenuhi: getOppositeCheckmark(vi.girdercorrosionMemenuhi),
        girdercorrosionResult: vi.girdercorrosionResult || '',
        girdercracksMemenuhi: getCheckmark(vi.girdercracksMemenuhi),
        girdercracksTidakMemenuhi: getOppositeCheckmark(vi.girdercracksMemenuhi),
        girdercracksResult: vi.girdercracksResult || '',
        girdercamberMemenuhi: getCheckmark(vi.girdercamberMemenuhi),
        girdercamberTidakMemenuhi: getOppositeCheckmark(vi.girdercamberMemenuhi),
        girdercamberResult: vi.girdercamberResult || '',
        girderConnectionMemenuhi: getCheckmark(vi.girderConnectionMemenuhi),
        girderConnectionTidakMemenuhi: getOppositeCheckmark(vi.girderConnectionMemenuhi),
        girderConnectionResult: vi.girderConnectionResult || '',
        girderendGirderConnectionMemenuhi: getCheckmark(vi.girderendGirderConnectionMemenuhi),
        girderendGirderConnectionTidakMemenuhi: getOppositeCheckmark(vi.girderendGirderConnectionMemenuhi),
        girderendGirderConnectionResult: vi.girderendGirderConnectionResult || '',
        girdertruckMountingOnGirderMemenuhi: getCheckmark(vi.girdertruckMountingOnGirderMemenuhi),
        girdertruckMountingOnGirderTidakMemenuhi: getOppositeCheckmark(vi.girdertruckMountingOnGirderMemenuhi),
        girdertruckMountingOnGirderResult: vi.girdertruckMountingOnGirderResult || '',
        travelingGearboxcorrosionMemenuhi: getCheckmark(vi.travelingGearboxcorrosionMemenuhi),
        travelingGearboxcorrosionTidakMemenuhi: getOppositeCheckmark(vi.travelingGearboxcorrosionMemenuhi),
        travelingGearboxcorrosionResult: vi.travelingGearboxcorrosionResult || '',
        travelingGearboxcracksMemenuhi: getCheckmark(vi.travelingGearboxcracksMemenuhi),
        travelingGearboxcracksTidakMemenuhi: getOppositeCheckmark(vi.travelingGearboxcracksMemenuhi),
        travelingGearboxcracksResult: vi.travelingGearboxcracksResult || '',
        travelingGearboxlubricatingOilMemenuhi: getCheckmark(vi.travelingGearboxlubricatingOilMemenuhi),
        travelingGearboxlubricatingOilTidakMemenuhi: getOppositeCheckmark(vi.travelingGearboxlubricatingOilMemenuhi),
        travelingGearboxlubricatingOilResult: vi.travelingGearboxlubricatingOilResult || '',
        travelingGearboxoilSealMemenuhi: getCheckmark(vi.travelingGearboxoilSealMemenuhi),
        travelingGearboxoilSealTidakMemenuhi: getOppositeCheckmark(vi.travelingGearboxoilSealMemenuhi),
        travelingGearboxoilSealResult: vi.travelingGearboxoilSealResult || '',
        driveWheelswearMemenuhi: getCheckmark(vi.driveWheelswearMemenuhi),
        driveWheelswearTidakMemenuhi: getOppositeCheckmark(vi.driveWheelswearMemenuhi),
        driveWheelswearResult: vi.driveWheelswearResult || '',
        driveWheelscracksMemenuhi: getCheckmark(vi.driveWheelscracksMemenuhi),
        driveWheelscracksTidakMemenuhi: getOppositeCheckmark(vi.driveWheelscracksMemenuhi),
        driveWheelscracksResult: vi.driveWheelscracksResult || '',
        driveWheelsdeformationMemenuhi: getCheckmark(vi.driveWheelsdeformationMemenuhi),
        driveWheelsdeformationTidakMemenuhi: getOppositeCheckmark(vi.driveWheelsdeformationMemenuhi),
        driveWheelsdeformationResult: vi.driveWheelsdeformationResult || '',
        driveWheelsflangeConditionMemenuhi: getCheckmark(vi.driveWheelsflangeConditionMemenuhi),
        driveWheelsflangeConditionTidakMemenuhi: getOppositeCheckmark(vi.driveWheelsflangeConditionMemenuhi),
        driveWheelsflangeConditionResult: vi.driveWheelsflangeConditionResult || '',
        driveWheelschainConditionMemenuhi: getCheckmark(vi.driveWheelschainConditionMemenuhi),
        driveWheelschainConditionTidakMemenuhi: getOppositeCheckmark(vi.driveWheelschainConditionMemenuhi),
        driveWheelschainConditionResult: vi.driveWheelschainConditionResult || '',
        idleWheelssafetyMemenuhi: getCheckmark(vi.idleWheelssafetyMemenuhi),
        idleWheelssafetyTidakMemenuhi: getOppositeCheckmark(vi.idleWheelssafetyMemenuhi),
        idleWheelssafetyResult: vi.idleWheelssafetyResult || '',
        idleWheelscracksMemenuhi: getCheckmark(vi.idleWheelscracksMemenuhi),
        idleWheelscracksTidakMemenuhi: getOppositeCheckmark(vi.idleWheelscracksMemenuhi),
        idleWheelscracksResult: vi.idleWheelscracksResult || '',
        idleWheelsdeformationMemenuhi: getCheckmark(vi.idleWheelsdeformationMemenuhi),
        idleWheelsdeformationTidakMemenuhi: getOppositeCheckmark(vi.idleWheelsdeformationMemenuhi),
        idleWheelsdeformationResult: vi.idleWheelsdeformationResult || '',
        idleWheelsflangeConditionMemenuhi: getCheckmark(vi.idleWheelsflangeConditionMemenuhi),
        idleWheelsflangeConditionTidakMemenuhi: getOppositeCheckmark(vi.idleWheelsflangeConditionMemenuhi),
        idleWheelsflangeConditionResult: vi.idleWheelsflangeConditionResult || '',
        wheelConnectoralignmentMemenuhi: getCheckmark(vi.wheelConnectoralignmentMemenuhi),
        wheelConnectoralignmentTidakMemenuhi: getOppositeCheckmark(vi.wheelConnectoralignmentMemenuhi),
        wheelConnectoralignmentResult: vi.wheelConnectoralignmentResult || '',
        wheelConnectorcrossJointMemenuhi: getCheckmark(vi.wheelConnectorcrossJointMemenuhi),
        wheelConnectorcrossJointTidakMemenuhi: getOppositeCheckmark(vi.wheelConnectorcrossJointMemenuhi),
        wheelConnectorcrossJointResult: vi.wheelConnectorcrossJointResult || '',
        wheelConnectorlubricationMemenuhi: getCheckmark(vi.wheelConnectorlubricationMemenuhi),
        wheelConnectorlubricationTidakMemenuhi: getOppositeCheckmark(vi.wheelConnectorlubricationMemenuhi),
        wheelConnectorlubricationResult: vi.wheelConnectorlubricationResult || '',
        girderStopperconditionMemenuhi: getCheckmark(vi.girderStopperconditionMemenuhi),
        girderStopperconditionTidakMemenuhi: getOppositeCheckmark(vi.girderStopperconditionMemenuhi),
        girderStopperconditionResult: vi.girderStopperconditionResult || '',
        girderStopperreinforcementMemenuhi: getCheckmark(vi.girderStopperreinforcementMemenuhi),
        girderStopperreinforcementTidakMemenuhi: getOppositeCheckmark(vi.girderStopperreinforcementMemenuhi),
        girderStopperreinforcementResult: vi.girderStopperreinforcementResult || '',
        trolleyTraversingGearboxfasteningMemenuhi: getCheckmark(vi.trolleyTraversingGearboxfasteningMemenuhi),
        trolleyTraversingGearboxfasteningTidakMemenuhi: getOppositeCheckmark(vi.trolleyTraversingGearboxfasteningMemenuhi),
        trolleyTraversingGearboxfasteningResult: vi.trolleyTraversingGearboxfasteningResult || '',
        trolleyTraversingGearboxcorrosionMemenuhi: getCheckmark(vi.trolleyTraversingGearboxcorrosionMemenuhi),
        trolleyTraversingGearboxcorrosionTidakMemenuhi: getOppositeCheckmark(vi.trolleyTraversingGearboxcorrosionMemenuhi),
        trolleyTraversingGearboxcorrosionResult: vi.trolleyTraversingGearboxcorrosionResult || '',
        trolleyTraversingGearboxcracksMemenuhi: getCheckmark(vi.trolleyTraversingGearboxcracksMemenuhi),
        trolleyTraversingGearboxcracksTidakMemenuhi: getOppositeCheckmark(vi.trolleyTraversingGearboxcracksMemenuhi),
        trolleyTraversingGearboxcracksResult: vi.trolleyTraversingGearboxcracksResult || '',
        trolleyTraversingGearboxlubricatingOilMemenuhi: getCheckmark(vi.trolleyTraversingGearboxlubricatingOilMemenuhi),
        trolleyTraversingGearboxlubricatingOilTidakMemenuhi: getOppositeCheckmark(vi.trolleyTraversingGearboxlubricatingOilMemenuhi),
        trolleyTraversingGearboxlubricatingOilResult: vi.trolleyTraversingGearboxlubricatingOilResult || '',
        trolleyTraversingGearboxoilSealMemenuhi: getCheckmark(vi.trolleyTraversingGearboxoilSealMemenuhi),
        trolleyTraversingGearboxoilSealTidakMemenuhi: getOppositeCheckmark(vi.trolleyTraversingGearboxoilSealMemenuhi),
        trolleyTraversingGearboxoilSealResult: vi.trolleyTraversingGearboxoilSealResult || '',
        trolleyDriveWheelswearMemenuhi: getCheckmark(vi.trolleyDriveWheelswearMemenuhi),
        trolleyDriveWheelswearTidakMemenuhi: getOppositeCheckmark(vi.trolleyDriveWheelswearMemenuhi),
        trolleyDriveWheelswearResult: vi.trolleyDriveWheelswearResult || '',
        trolleyDriveWheelscracksMemenuhi: getCheckmark(vi.trolleyDriveWheelscracksMemenuhi),
        trolleyDriveWheelscracksTidakMemenuhi: getOppositeCheckmark(vi.trolleyDriveWheelscracksMemenuhi),
        trolleyDriveWheelscracksResult: vi.trolleyDriveWheelscracksResult || '',
        trolleyDriveWheelsdeformationMemenuhi: getCheckmark(vi.trolleyDriveWheelsdeformationMemenuhi),
        trolleyDriveWheelsdeformationTidakMemenuhi: getOppositeCheckmark(vi.trolleyDriveWheelsdeformationMemenuhi),
        trolleyDriveWheelsdeformationResult: vi.trolleyDriveWheelsdeformationResult || '',
        trolleyDriveWheelsflangeConditionMemenuhi: getCheckmark(vi.trolleyDriveWheelsflangeConditionMemenuhi),
        trolleyDriveWheelsflangeConditionTidakMemenuhi: getOppositeCheckmark(vi.trolleyDriveWheelsflangeConditionMemenuhi),
        trolleyDriveWheelsflangeConditionResult: vi.trolleyDriveWheelsflangeConditionResult || '',
        trolleyDriveWheelschainConditionMemenuhi: getCheckmark(vi.trolleyDriveWheelschainConditionMemenuhi),
        trolleyDriveWheelschainConditionTidakMemenuhi: getOppositeCheckmark(vi.trolleyDriveWheelschainConditionMemenuhi),
        trolleyDriveWheelschainConditionResult: vi.trolleyDriveWheelschainConditionResult || '',
        trolleyIdleWheelswearMemenuhi: getCheckmark(vi.trolleyIdleWheelswearMemenuhi),
        trolleyIdleWheelswearTidakMemenuhi: getOppositeCheckmark(vi.trolleyIdleWheelswearMemenuhi),
        trolleyIdleWheelswearResult: vi.trolleyIdleWheelswearResult || '',
        trolleyIdleWheelscracksMemenuhi: getCheckmark(vi.trolleyIdleWheelscracksMemenuhi),
        trolleyIdleWheelscracksTidakMemenuhi: getOppositeCheckmark(vi.trolleyIdleWheelscracksMemenuhi),
        trolleyIdleWheelscracksResult: vi.trolleyIdleWheelscracksResult || '',
        trolleyIdleWheelsdeformationMemenuhi: getCheckmark(vi.trolleyIdleWheelsdeformationMemenuhi),
        trolleyIdleWheelsdeformationTidakMemenuhi: getOppositeCheckmark(vi.trolleyIdleWheelsdeformationMemenuhi),
        trolleyIdleWheelsdeformationResult: vi.trolleyIdleWheelsdeformationResult || '',
        trolleyIdleWheelsflangeConditionMemenuhi: getCheckmark(vi.trolleyIdleWheelsflangeConditionMemenuhi),
        trolleyIdleWheelsflangeConditionTidakMemenuhi: getOppositeCheckmark(vi.trolleyIdleWheelsflangeConditionMemenuhi),
        trolleyIdleWheelsflangeConditionResult: vi.trolleyIdleWheelsflangeConditionResult || '',
        trolleyWheelConnectoralignmentMemenuhi: getCheckmark(vi.trolleyWheelConnectoralignmentMemenuhi),
        trolleyWheelConnectoralignmentTidakMemenuhi: getOppositeCheckmark(vi.trolleyWheelConnectoralignmentMemenuhi),
        trolleyWheelConnectoralignmentResult: vi.trolleyWheelConnectoralignmentResult || '',
        trolleyWheelConnectorcrossJointMemenuhi: getCheckmark(vi.trolleyWheelConnectorcrossJointMemenuhi),
        trolleyWheelConnectorcrossJointTidakMemenuhi: getOppositeCheckmark(vi.trolleyWheelConnectorcrossJointMemenuhi),
        trolleyWheelConnectorcrossJointResult: vi.trolleyWheelConnectorcrossJointResult || '',
        trolleyWheelConnectorlubricationMemenuhi: getCheckmark(vi.trolleyWheelConnectorlubricationMemenuhi),
        trolleyWheelConnectorlubricationTidakMemenuhi: getOppositeCheckmark(vi.trolleyWheelConnectorlubricationMemenuhi),
        trolleyWheelConnectorlubricationResult: vi.trolleyWheelConnectorlubricationResult || '',
        trolleyGirderStopperconditionMemenuhi: getCheckmark(vi.trolleyGirderStopperconditionMemenuhi),
        trolleyGirderStopperconditionTidakMemenuhi: getOppositeCheckmark(vi.trolleyGirderStopperconditionMemenuhi),
        trolleyGirderStopperconditionResult: vi.trolleyGirderStopperconditionResult || '',
        trolleyGirderStopperreinforcementMemenuhi: getCheckmark(vi.trolleyGirderStopperreinforcementMemenuhi),
        trolleyGirderStopperreinforcementTidakMemenuhi: getOppositeCheckmark(vi.trolleyGirderStopperreinforcementMemenuhi),
        trolleyGirderStopperreinforcementResult: vi.trolleyGirderStopperreinforcementResult || '',
        windingDrumgrooveMemenuhi: getCheckmark(vi.windingDrumgrooveMemenuhi),
        windingDrumgrooveTidakMemenuhi: getOppositeCheckmark(vi.windingDrumgrooveMemenuhi),
        windingDrumgrooveResult: vi.windingDrumgrooveResult || '',
        windingDrumgrooveLipMemenuhi: getCheckmark(vi.windingDrumgrooveLipMemenuhi),
        windingDrumgrooveLipTidakMemenuhi: getOppositeCheckmark(vi.windingDrumgrooveLipMemenuhi),
        windingDrumgrooveLipResult: vi.windingDrumgrooveLipResult || '',
        windingDrumflangesMemenuhi: getCheckmark(vi.windingDrumflangesMemenuhi),
        windingDrumflangesTidakMemenuhi: getOppositeCheckmark(vi.windingDrumflangesMemenuhi),
        windingDrumflangesResult: vi.windingDrumflangesResult || '',
        visualBrakeInspectionwearMemenuhi: getCheckmark(vi.visualBrakeInspectionwearMemenuhi),
        visualBrakeInspectionwearTidakMemenuhi: getOppositeCheckmark(vi.visualBrakeInspectionwearMemenuhi),
        visualBrakeInspectionwearResult: vi.visualBrakeInspectionwearResult || '',
        visualBrakeInspectionadjustmentMemenuhi: getCheckmark(vi.visualBrakeInspectionadjustmentMemenuhi),
        visualBrakeInspectionadjustmentTidakMemenuhi: getOppositeCheckmark(vi.visualBrakeInspectionadjustmentMemenuhi),
        visualBrakeInspectionadjustmentResult: vi.visualBrakeInspectionadjustmentResult || '',
        hoistGearboxlubricationMemenuhi: getCheckmark(vi.hoistGearboxlubricationMemenuhi),
        hoistGearboxlubricationTidakMemenuhi: getOppositeCheckmark(vi.hoistGearboxlubricationMemenuhi),
        hoistGearboxlubricationResult: vi.hoistGearboxlubricationResult || '',
        hoistGearboxoilSealMemenuhi: getCheckmark(vi.hoistGearboxoilSealMemenuhi),
        hoistGearboxoilSealTidakMemenuhi: getOppositeCheckmark(vi.hoistGearboxoilSealMemenuhi),
        hoistGearboxoilSealResult: vi.hoistGearboxoilSealResult || '',
        pulleySprocketpulleyGrooveMemenuhi: getCheckmark(vi.pulleySprocketpulleyGrooveMemenuhi),
        pulleySprocketpulleyGrooveTidakMemenuhi: getOppositeCheckmark(vi.pulleySprocketpulleyGrooveMemenuhi),
        pulleySprocketpulleyGrooveResult: vi.pulleySprocketpulleyGrooveResult || '',
        pulleySprocketpulleyLipMemenuhi: getCheckmark(vi.pulleySprocketpulleyLipMemenuhi),
        pulleySprocketpulleyLipTidakMemenuhi: getOppositeCheckmark(vi.pulleySprocketpulleyLipMemenuhi),
        pulleySprocketpulleyLipResult: vi.pulleySprocketpulleyLipResult || '',
        pulleySprocketpulleyPinMemenuhi: getCheckmark(vi.pulleySprocketpulleyPinMemenuhi),
        pulleySprocketpulleyPinTidakMemenuhi: getOppositeCheckmark(vi.pulleySprocketpulleyPinMemenuhi),
        pulleySprocketpulleyPinResult: vi.pulleySprocketpulleyPinResult || '',
        pulleySprocketbearingMemenuhi: getCheckmark(vi.pulleySprocketbearingMemenuhi),
        pulleySprocketbearingTidakMemenuhi: getOppositeCheckmark(vi.pulleySprocketbearingMemenuhi),
        pulleySprocketbearingResult: vi.pulleySprocketbearingResult || '',
        pulleySprocketpulleyGuardMemenuhi: getCheckmark(vi.pulleySprocketpulleyGuardMemenuhi),
        pulleySprocketpulleyGuardTidakMemenuhi: getOppositeCheckmark(vi.pulleySprocketpulleyGuardMemenuhi),
        pulleySprocketpulleyGuardResult: vi.pulleySprocketpulleyGuardResult || '',
        pulleySprocketropeChainGuardMemenuhi: getCheckmark(vi.pulleySprocketropeChainGuardMemenuhi),
        pulleySprocketropeChainGuardTidakMemenuhi: getOppositeCheckmark(vi.pulleySprocketropeChainGuardMemenuhi),
        pulleySprocketropeChainGuardResult: vi.pulleySprocketropeChainGuardResult || '',
        mainHookInspectionwearMemenuhi: getCheckmark(vi.mainHookInspectionwearMemenuhi),
        mainHookInspectionwearTidakMemenuhi: getOppositeCheckmark(vi.mainHookInspectionwearMemenuhi),
        mainHookInspectionwearResult: vi.mainHookInspectionwearResult || '',
        mainHookInspectionhookOpeningGapMemenuhi: getCheckmark(vi.mainHookInspectionhookOpeningGapMemenuhi),
        mainHookInspectionhookOpeningGapTidakMemenuhi: getOppositeCheckmark(vi.mainHookInspectionhookOpeningGapMemenuhi),
        mainHookInspectionhookOpeningGapResult: vi.mainHookInspectionhookOpeningGapResult || '',
        mainHookInspectionswivelNutAndBearingMemenuhi: getCheckmark(vi.mainHookInspectionswivelNutAndBearingMemenuhi),
        mainHookInspectionswivelNutAndBearingTidakMemenuhi: getOppositeCheckmark(vi.mainHookInspectionswivelNutAndBearingMemenuhi),
        mainHookInspectionswivelNutAndBearingResult: vi.mainHookInspectionswivelNutAndBearingResult || '',
        mainHookInspectiontrunnionMemenuhi: getCheckmark(vi.mainHookInspectiontrunnionMemenuhi),
        mainHookInspectiontrunnionTidakMemenuhi: getOppositeCheckmark(vi.mainHookInspectiontrunnionMemenuhi),
        mainHookInspectiontrunnionResult: vi.mainHookInspectiontrunnionResult || '',
        auxiliaryHookInspectionwearMemenuhi: getCheckmark(vi.auxiliaryHookInspectionwearMemenuhi),
        auxiliaryHookInspectionwearTidakMemenuhi: getOppositeCheckmark(vi.auxiliaryHookInspectionwearMemenuhi),
        auxiliaryHookInspectionwearResult: vi.auxiliaryHookInspectionwearResult || '',
        auxiliaryHookInspectionhookOpeningGapMemenuhi: getCheckmark(vi.auxiliaryHookInspectionhookOpeningGapMemenuhi),
        auxiliaryHookInspectionhookOpeningGapTidakMemenuhi: getOppositeCheckmark(vi.auxiliaryHookInspectionhookOpeningGapMemenuhi),
        auxiliaryHookInspectionhookOpeningGapResult: vi.auxiliaryHookInspectionhookOpeningGapResult || '',
        auxiliaryHookInspectionswivelNutAndBearingMemenuhi: getCheckmark(vi.auxiliaryHookInspectionswivelNutAndBearingMemenuhi),
        auxiliaryHookInspectionswivelNutAndBearingTidakMemenuhi: getOppositeCheckmark(vi.auxiliaryHookInspectionswivelNutAndBearingMemenuhi),
        auxiliaryHookInspectionswivelNutAndBearingResult: vi.auxiliaryHookInspectionswivelNutAndBearingResult || '',
        auxiliaryHookInspectiontrunnionMemenuhi: getCheckmark(vi.auxiliaryHookInspectiontrunnionMemenuhi),
        auxiliaryHookInspectiontrunnionTidakMemenuhi: getOppositeCheckmark(vi.auxiliaryHookInspectiontrunnionMemenuhi),
        auxiliaryHookInspectiontrunnionResult: vi.auxiliaryHookInspectiontrunnionResult || '',
        mainWireRopeInspectioncorrosionMemenuhi: getCheckmark(vi.mainWireRopeInspectioncorrosionMemenuhi),
        mainWireRopeInspectioncorrosionTidakMemenuhi: getOppositeCheckmark(vi.mainWireRopeInspectioncorrosionMemenuhi),
        mainWireRopeInspectioncorrosionResult: vi.mainWireRopeInspectioncorrosionResult || '',
        mainWireRopeInspectionwearMemenuhi: getCheckmark(vi.mainWireRopeInspectionwearMemenuhi),
        mainWireRopeInspectionwearTidakMemenuhi: getOppositeCheckmark(vi.mainWireRopeInspectionwearMemenuhi),
        mainWireRopeInspectionwearResult: vi.mainWireRopeInspectionwearResult || '',
        mainWireRopeInspectionbreakageMemenuhi: getCheckmark(vi.mainWireRopeInspectionbreakageMemenuhi),
        mainWireRopeInspectionbreakageTidakMemenuhi: getOppositeCheckmark(vi.mainWireRopeInspectionbreakageMemenuhi),
        mainWireRopeInspectionbreakageResult: vi.mainWireRopeInspectionbreakageResult || '',
        mainWireRopeInspectiondeformationMemenuhi: getCheckmark(vi.mainWireRopeInspectiondeformationMemenuhi),
        mainWireRopeInspectiondeformationTidakMemenuhi: getOppositeCheckmark(vi.mainWireRopeInspectiondeformationMemenuhi),
        mainWireRopeInspectiondeformationResult: vi.mainWireRopeInspectiondeformationResult || '',
        auxiliaryWireRopeInspectioncorrosionMemenuhi: getCheckmark(vi.auxiliaryWireRopeInspectioncorrosionMemenuhi),
        auxiliaryWireRopeInspectioncorrosionTidakMemenuhi: getOppositeCheckmark(vi.auxiliaryWireRopeInspectioncorrosionMemenuhi),
        auxiliaryWireRopeInspectioncorrosionResult: vi.auxiliaryWireRopeInspectioncorrosionResult || '',
        auxiliaryWireRopeInspectionwearMemenuhi: getCheckmark(vi.auxiliaryWireRopeInspectionwearMemenuhi),
        auxiliaryWireRopeInspectionwearTidakMemenuhi: getOppositeCheckmark(vi.auxiliaryWireRopeInspectionwearMemenuhi),
        auxiliaryWireRopeInspectionwearResult: vi.auxiliaryWireRopeInspectionwearResult || '',
        auxiliaryWireRopeInspectionbreakageMemenuhi: getCheckmark(vi.auxiliaryWireRopeInspectionbreakageMemenuhi),
        auxiliaryWireRopeInspectionbreakageTidakMemenuhi: getOppositeCheckmark(vi.auxiliaryWireRopeInspectionbreakageMemenuhi),
        auxiliaryWireRopeInspectionbreakageResult: vi.auxiliaryWireRopeInspectionbreakageResult || '',
        auxiliaryWireRopeInspectiondeformationMemenuhi: getCheckmark(vi.auxiliaryWireRopeInspectiondeformationMemenuhi),
        auxiliaryWireRopeInspectiondeformationTidakMemenuhi: getOppositeCheckmark(vi.auxiliaryWireRopeInspectiondeformationMemenuhi),
        auxiliaryWireRopeInspectiondeformationResult: vi.auxiliaryWireRopeInspectiondeformationResult || '',
        mainChainInspectioncorrosionMemenuhi: getCheckmark(vi.mainChainInspectioncorrosionMemenuhi),
        mainChainInspectioncorrosionTidakMemenuhi: getOppositeCheckmark(vi.mainChainInspectioncorrosionMemenuhi),
        mainChainInspectioncorrosionResult: vi.mainChainInspectioncorrosionResult || '',
        mainChainInspectionwearMemenuhi: getCheckmark(vi.mainChainInspectionwearMemenuhi),
        mainChainInspectionwearTidakMemenuhi: getOppositeCheckmark(vi.mainChainInspectionwearMemenuhi),
        mainChainInspectionwearResult: vi.mainChainInspectionwearResult || '',
        mainChainInspectioncrackOrBreakageMemenuhi: getCheckmark(vi.mainChainInspectioncrackOrBreakageMemenuhi),
        mainChainInspectioncrackOrBreakageTidakMemenuhi: getOppositeCheckmark(vi.mainChainInspectioncrackOrBreakageMemenuhi),
        mainChainInspectioncrackOrBreakageResult: vi.mainChainInspectioncrackOrBreakageResult || '',
        mainChainInspectiondeformationMemenuhi: getCheckmark(vi.mainChainInspectiondeformationMemenuhi),
        mainChainInspectiondeformationTidakMemenuhi: getOppositeCheckmark(vi.mainChainInspectiondeformationMemenuhi),
        mainChainInspectiondeformationResult: vi.mainChainInspectiondeformationResult || '',
        auxiliaryChainInspectioncorrosionMemenuhi: getCheckmark(vi.auxiliaryChainInspectioncorrosionMemenuhi),
        auxiliaryChainInspectioncorrosionTidakMemenuhi: getOppositeCheckmark(vi.auxiliaryChainInspectioncorrosionMemenuhi),
        auxiliaryChainInspectioncorrosionResult: vi.auxiliaryChainInspectioncorrosionResult || '',
        auxiliaryChainInspectionwearMemenuhi: getCheckmark(vi.auxiliaryChainInspectionwearMemenuhi),
        auxiliaryChainInspectionwearTidakMemenuhi: getOppositeCheckmark(vi.auxiliaryChainInspectionwearMemenuhi),
        auxiliaryChainInspectionwearResult: vi.auxiliaryChainInspectionwearResult || '',
        auxiliaryChainInspectioncrackOrBreakageMemenuhi: getCheckmark(vi.auxiliaryChainInspectioncrackOrBreakageMemenuhi),
        auxiliaryChainInspectioncrackOrBreakageTidakMemenuhi: getOppositeCheckmark(vi.auxiliaryChainInspectioncrackOrBreakageMemenuhi),
        auxiliaryChainInspectioncrackOrBreakageResult: vi.auxiliaryChainInspectioncrackOrBreakageResult || '',
        auxiliaryChainInspectiondeformationMemenuhi: getCheckmark(vi.auxiliaryChainInspectiondeformationMemenuhi),
        auxiliaryChainInspectiondeformationTidakMemenuhi: getOppositeCheckmark(vi.auxiliaryChainInspectiondeformationMemenuhi),
        auxiliaryChainInspectiondeformationResult: vi.auxiliaryChainInspectiondeformationResult || '',
        limitSwitchlongTravelMemenuhi: getCheckmark(vi.limitSwitchlongTravelMemenuhi),
        limitSwitchlongTravelTidakMemenuhi: getOppositeCheckmark(vi.limitSwitchlongTravelMemenuhi),
        limitSwitchlongTravelResult: vi.limitSwitchlongTravelResult || '',
        limitSwitchcrossTravelMemenuhi: getCheckmark(vi.limitSwitchcrossTravelMemenuhi),
        limitSwitchcrossTravelTidakMemenuhi: getOppositeCheckmark(vi.limitSwitchcrossTravelMemenuhi),
        limitSwitchcrossTravelResult: vi.limitSwitchcrossTravelResult || '',
        limitSwitchhoistMemenuhi: getCheckmark(vi.limitSwitchhoistMemenuhi),
        limitSwitchhoistTidakMemenuhi: getOppositeCheckmark(vi.limitSwitchhoistMemenuhi),
        limitSwitchhoistResult: vi.limitSwitchhoistResult || '',
        operatorCabinsafetyLadderMemenuhi: getCheckmark(vi.operatorCabinsafetyLadderMemenuhi),
        operatorCabinsafetyLadderTidakMemenuhi: getOppositeCheckmark(vi.operatorCabinsafetyLadderMemenuhi),
        operatorCabinsafetyLadderResult: vi.operatorCabinsafetyLadderResult || '',
        operatorCabindoorMemenuhi: getCheckmark(vi.operatorCabindoorMemenuhi),
        operatorCabindoorTidakMemenuhi: getOppositeCheckmark(vi.operatorCabindoorMemenuhi),
        operatorCabindoorResult: vi.operatorCabindoorResult || '',
        operatorCabinwindowMemenuhi: getCheckmark(vi.operatorCabinwindowMemenuhi),
        operatorCabinwindowTidakMemenuhi: getOppositeCheckmark(vi.operatorCabinwindowMemenuhi),
        operatorCabinwindowResult: vi.operatorCabinwindowResult || '',
        operatorCabinfanOrACMemenuhi: getCheckmark(vi.operatorCabinfanOrACMemenuhi),
        operatorCabinfanOrACTidakMemenuhi: getOppositeCheckmark(vi.operatorCabinfanOrACMemenuhi),
        operatorCabinfanOrACResult: vi.operatorCabinfanOrACResult || '',
        operatorCabincontrolLeversOrButtonsMemenuhi: getCheckmark(vi.operatorCabincontrolLeversOrButtonsMemenuhi),
        operatorCabincontrolLeversOrButtonsTidakMemenuhi: getOppositeCheckmark(vi.operatorCabincontrolLeversOrButtonsMemenuhi),
        operatorCabincontrolLeversOrButtonsResult: vi.operatorCabincontrolLeversOrButtonsResult || '',
        operatorCabinpendantControlMemenuhi: getCheckmark(vi.operatorCabinpendantControlMemenuhi),
        operatorCabinpendantControlTidakMemenuhi: getOppositeCheckmark(vi.operatorCabinpendantControlMemenuhi),
        operatorCabinpendantControlResult: vi.operatorCabinpendantControlResult || '',
        operatorCabinlightingMemenuhi: getCheckmark(vi.operatorCabinlightingMemenuhi),
        operatorCabinlightingTidakMemenuhi: getOppositeCheckmark(vi.operatorCabinlightingMemenuhi),
        operatorCabinlightingResult: vi.operatorCabinlightingResult || '',
        operatorCabinhornMemenuhi: getCheckmark(vi.operatorCabinhornMemenuhi),
        operatorCabinhornTidakMemenuhi: getOppositeCheckmark(vi.operatorCabinhornMemenuhi),
        operatorCabinhornResult: vi.operatorCabinhornResult || '',
        operatorCabinfuseProtectionMemenuhi: getCheckmark(vi.operatorCabinfuseProtectionMemenuhi),
        operatorCabinfuseProtectionTidakMemenuhi: getOppositeCheckmark(vi.operatorCabinfuseProtectionMemenuhi),
        operatorCabinfuseProtectionResult: vi.operatorCabinfuseProtectionResult || '',
        operatorCabincommunicationDeviceMemenuhi: getCheckmark(vi.operatorCabincommunicationDeviceMemenuhi),
        operatorCabincommunicationDeviceTidakMemenuhi: getOppositeCheckmark(vi.operatorCabincommunicationDeviceMemenuhi),
        operatorCabincommunicationDeviceResult: vi.operatorCabincommunicationDeviceResult || '',
        operatorCabinfireExtinguisherMemenuhi: getCheckmark(vi.operatorCabinfireExtinguisherMemenuhi),
        operatorCabinfireExtinguisherTidakMemenuhi: getOppositeCheckmark(vi.operatorCabinfireExtinguisherMemenuhi),
        operatorCabinfireExtinguisherResult: vi.operatorCabinfireExtinguisherResult || '',
        operatorCabinoperationalSignsMemenuhi: getCheckmark(vi.operatorCabinoperationalSignsMemenuhi),
        operatorCabinoperationalSignsTidakMemenuhi: getOppositeCheckmark(vi.operatorCabinoperationalSignsMemenuhi),
        operatorCabinoperationalSignsResult: vi.operatorCabinoperationalSignsResult || '',
        operatorCabinignitionOrMasterSwitchMemenuhi: getCheckmark(vi.operatorCabinignitionOrMasterSwitchMemenuhi),
        operatorCabinignitionOrMasterSwitchTidakMemenuhi: getOppositeCheckmark(vi.operatorCabinignitionOrMasterSwitchMemenuhi),
        operatorCabinignitionOrMasterSwitchResult: vi.operatorCabinignitionOrMasterSwitchResult || '',
        electricalComponentspanelConductorConnectorMemenuhi: getCheckmark(vi.electricalComponentspanelConductorConnectorMemenuhi),
        electricalComponentspanelConductorConnectorTidakMemenuhi: getOppositeCheckmark(vi.electricalComponentspanelConductorConnectorMemenuhi),
        electricalComponentspanelConductorConnectorResult: vi.electricalComponentspanelConductorConnectorResult || '',
        electricalComponentsconductorProtectionMemenuhi: getCheckmark(vi.electricalComponentsconductorProtectionMemenuhi),
        electricalComponentsconductorProtectionTidakMemenuhi: getOppositeCheckmark(vi.electricalComponentsconductorProtectionMemenuhi),
        electricalComponentsconductorProtectionResult: vi.electricalComponentsconductorProtectionResult || '',
        electricalComponentsmotorInstallationSafetySystemMemenuhi: getCheckmark(vi.electricalComponentsmotorInstallationSafetySystemMemenuhi),
        electricalComponentsmotorInstallationSafetySystemTidakMemenuhi: getOppositeCheckmark(vi.electricalComponentsmotorInstallationSafetySystemMemenuhi),
        electricalComponentsmotorInstallationSafetySystemResult: vi.electricalComponentsmotorInstallationSafetySystemResult || '',
        electricalComponentsgroundingSystemMemenuhi: getCheckmark(vi.electricalComponentsgroundingSystemMemenuhi),
        electricalComponentsgroundingSystemTidakMemenuhi: getOppositeCheckmark(vi.electricalComponentsgroundingSystemMemenuhi),
        electricalComponentsgroundingSystemResult: vi.electricalComponentsgroundingSystemResult || '',
        electricalComponentsinstallationMemenuhi: getCheckmark(vi.electricalComponentsinstallationMemenuhi),
        electricalComponentsinstallationTidakMemenuhi: getOppositeCheckmark(vi.electricalComponentsinstallationMemenuhi),
        electricalComponentsinstallationResult: vi.electricalComponentsinstallationResult || '',

        // NDT (Non-Destructive Testing)
        wireropeMethod: ndt.wireropeMethod,
        wireropeItems: (ndt.wireropeNumber || []).map(item => ({
            wireropeUsed: item.wireropeUsed,
            dimensionSpec: item.dimensionSpec,
            dimensionResult: item.dimensionResult,
            construction: item.construction,
            type: item.type,
            length: item.length,
            age: item.age,
            defectAda: getCheckmark(item.defectAda),
            defectTidakAda: getOppositeCheckmark(item.defectAda),
            description: item.description,
        })),
        HookspecA: ndt.HookspecA || '',
        HookspecB: ndt.HookspecB || '',
        HookspecC: ndt.HookspecC || '',
        HookspecD: ndt.HookspecD || '',
        HookspecE: ndt.HookspecE || '',
        HookspecF: ndt.HookspecF || '',
        HookspecG: ndt.HookspecG || '',
        HookspecH: ndt.HookspecH || '',
        HookspecBaik: getCheckmark(ndt.HookspecBaik),
        HookspecTidakBaik: getOppositeCheckmark(ndt.HookspecBaik),
        HookspecDesc: ndt.HookspecDesc || '',
        measurementResultsA: ndt.measurementResultsA || '',
        measurementResultsB: ndt.measurementResultsB || '',
        measurementResultsC: ndt.measurementResultsC || '',
        measurementResultsD: ndt.measurementResultsD || '',
        measurementResultsE: ndt.measurementResultsE || '',
        measurementResultsF: ndt.measurementResultsF || '',
        measurementResultsG: ndt.measurementResultsG || '',
        measurementResultsH: ndt.measurementResultsH || '',
        measurementResultsBaik: getCheckmark(ndt.measurementResultsBaik),
        measurementResultsTidakBaik: getOppositeCheckmark(ndt.measurementResultsBaik),
        measurementResultsDesc: ndt.measurementResultsDesc || '',
        toleranceA: ndt.toleranceA || '',
        toleranceB: ndt.toleranceB || '',
        toleranceC: ndt.toleranceC || '',
        toleranceD: ndt.toleranceD || '',
        toleranceE: ndt.toleranceE || '',
        toleranceF: ndt.toleranceF || '',
        toleranceG: ndt.toleranceG || '',
        toleranceH: ndt.toleranceH || '',
        toleranceBaik: getCheckmark(ndt.toleranceBaik),
        toleranceTidakBaik: getOppositeCheckmark(ndt.toleranceBaik),
        toleranceDesc: ndt.toleranceDesc || '',
        griderMethod: ndt.griderMethod,
        girderItems: (ndt.griderNumber || []).map(item => ({
            griderLocation: item.griderLocation,
            griderAda: getCheckmark(item.griderAda),
            griderTidakAda: getOppositeCheckmark(item.griderAda),
            griderDesc: item.griderDesc,
        })),

        // Dynamic Testing
        travellingStatus: dyn.travellingStatus || '',
        travellingDesc: dyn.travellingDesc || '',
        traversingStatus: dyn.traversingStatus || '',
        traversingDesc: dyn.traversingDesc || '',
        hoistingStatus: dyn.hoistingStatus || '',
        hoistingDesc: dyn.hoistingDesc || '',
        safetyDeviceStatus: dyn.safetyDeviceStatus || '',
        safetyDeviceDesc: dyn.safetyDeviceDesc || '',
        brakeSwitchStatus: dyn.brakeSwitchStatus || '',
        brakeSwitchDesc: dyn.brakeSwitchDesc || '',
        brakeLockingStatus: dyn.brakeLockingStatus || '',
        brakeLockingDesc: dyn.brakeLockingDesc || '',
        instalasionElectricStatus: dyn.instalasionElectricStatus || '',
        instalasionElectricDesc: dyn.instalasionElectricDesc || '',
        hoist25: dyn.hoist25 || '',
        travesing25: dyn.travesing25 || '',
        travelling25: dyn.travelling25 || '',
        brakeSystem25: dyn.brakeSystem25 || '',
        desc25: dyn.desc25 || '',
        hoist50: dyn.hoist50 || '',
        travesing50: dyn.travesing50 || '',
        travelling50: dyn.travelling50 || '',
        brakeSystem50: dyn.brakeSystem50 || '',
        desc50: dyn.desc50 || '',
        hoist75: dyn.hoist75 || '',
        travesing75: dyn.travesing75 || '',
        travelling75: dyn.travelling75 || '',
        brakeSystem75: dyn.brakeSystem75 || '',
        desc75: dyn.desc75 || '',
        hoist100: dyn.hoist100 || '',
        travesing100: dyn.travesing100 || '',
        travelling100: dyn.travelling100 || '',
        brakeSystem100: dyn.brakeSystem100 || '',
        desc100: dyn.desc100 || '',

        // Static Testing
        loadTest: stat.loadTest || '',
        basedDesign: stat.basedDesign || '',
        lengthSpan: stat.lengthSpan || '',
        xspan: stat.xspan || '',
        resultDefleksi: formatDefleksiResult(stat.resultDefleksi),
        defleksiItems: (stat.defleksiPosision || []).map(item => ({
            defleksiPosision: item.defleksiPosision,
            defleksiMeasuraments: item.defleksiMeasuraments,
            defleksiStandard: item.defleksiStandard,
            defleksiDesc: item.defleksiDesc,
        })),

        // Conclusion & Recommendation
        conclusion: data.conclusion || '',
        recomendation: data.recomendation || '',
    };

    try {
        doc.render(renderData);
    } catch (error) {
        console.error("GAGAL RENDER DOKUMEN:", error.message);
        const e = {
            message: error.message,
            name: error.name,
            stack: error.stack,
            properties: error.properties,
        };
        console.log(JSON.stringify({ error: e }));
        throw error;
    }

    const docxBuffer = doc.getZip().generate({ type: 'nodebuffer', compression: 'DEFLATE' });
    const ownerName = (g.companyName || 'UnknownCompany').replace(/[^\w.-]/g, '_');
    const fileName = `Laporan-GantryCrane-${ownerName}-${data.id}.docx`;

    return { docxBuffer, fileName };
};

module.exports = {
    createLaporanGantryCrane,
};